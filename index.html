<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æˆ‘çš„æ¸…å–®ï¼ˆæ¸¬è©¦ï¼‰</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Arial; padding: 16px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 12px; margin-top: 12px; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:6px; }
    button { padding:10px 12px; border-radius:10px; border:1px solid #ccc; background:#fff; }
  </style>
</head>
<body>
  <h2>ğŸ“Œ æˆ‘çš„æ¸…å–®ï¼ˆLIFF æ¸¬è©¦é ï¼‰</h2>
  <div class="card">
    <div>LIFF ç‹€æ…‹ï¼š<span id="status">åˆå§‹åŒ–ä¸­â€¦</span></div>
    <div style="margin-top:8px">isInClientï¼š<code id="inClient">-</code></div>
    <div style="margin-top:8px">userIdï¼š<code id="userId">-</code></div>
  </div>

  <div class="card">
    <button id="loginBtn" style="display:none;">ç™»å…¥ LINE</button>
    <button id="closeBtn" style="display:none;">é—œé–‰é é¢</button>
  </div>

  <script>
    const LIFF_ID = "2009075953-1UZ0h4p2"; // â† æ›æˆä½ çš„ LIFF ID

    const $ = (id) => document.getElementById(id);

    async function main() {
      try {
        await liff.init({ liffId: LIFF_ID });
        $("status").textContent = "âœ… åˆå§‹åŒ–æˆåŠŸ";
        $("inClient").textContent = String(liff.isInClient());

        // å¦‚æœä¸æ˜¯åœ¨ LINE App å…§é–‹ï¼Œå°±éœ€è¦ login
        if (!liff.isLoggedIn()) {
          $("loginBtn").style.display = "inline-block";
          $("loginBtn").onclick = () => liff.login();
          $("userId").textContent = "(å°šæœªç™»å…¥)";
          return;
        }

        const profile = await liff.getProfile();
        $("userId").textContent = profile.userId;

        if (liff.isInClient()) {
          $("closeBtn").style.display = "inline-block";
          $("closeBtn").onclick = () => liff.closeWindow();
        }
      } catch (e) {
        $("status").textContent = "âŒ åˆå§‹åŒ–å¤±æ•—";
        const msg = (e && (e.message || e.toString())) || "unknown";
        alert("LIFF init error: " + msg);
        console.error(e);
      }
    }

    main();
  </script>
</body>
</html>
